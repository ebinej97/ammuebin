<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Promise to You ❤️</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

    <style>
        html { scroll-behavior: smooth; }
        
        body {
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            background: linear-gradient(to bottom, #1a0b0f, #2d1b21); 
            color: #fff;
            font-family: 'Poppins', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-y: auto; 
            overflow-x: hidden;
            position: relative;
            padding-bottom: 350px; /* Extra space for scrolling */
        }

        /* Falling Petals */
        .petal {
            position: absolute;
            background-color: #ff4081;
            border-radius: 150% 0 150% 0;
            animation: fall 10s linear infinite;
            z-index: 1;
            opacity: 0.7;
            pointer-events: none; 
        }

        @keyframes fall {
            0% { transform: translate(0, -10vh) rotate(0deg); opacity: 1; }
            100% { transform: translate(100px, 110vh) rotate(360deg); opacity: 0; }
        }

        /* The Letter Container */
        .letter-container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            padding: 30px; 
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            max-width: 650px;
            width: 90%;
            z-index: 10;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            position: relative;
            margin-bottom: 50px; 
        }

        .profile-img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 3px solid #d81b60;
            object-fit: cover;
            margin: 0 auto 20px auto;
            display: block;
            box-shadow: 0 0 20px rgba(216, 27, 96, 0.6);
        }

        h1 {
            font-family: 'Dancing Script', cursive;
            text-align: center;
            font-size: 3rem;
            margin-bottom: 20px;
            color: #ff80ab;
            line-height: 1.2;
            text-shadow: 0 2px 5px rgba(0,0,0,0.5);
        }

        .message-box {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #e0e0e0;
            min-height: 100px;
            white-space: pre-wrap; 
        }

        /* Main Cursor for the typed letter */
        .cursor {
            display: inline-block;
            width: 2px;
            height: 20px;
            background-color: #ff80ab;
            animation: blink 1s infinite;
            vertical-align: middle;
        }

        @keyframes blink { 50% { opacity: 0; } }

        /* --- THE FINALE SECTION --- */
        .finale-section {
            margin-top: 60px;
            text-align: center;
            display: none; 
            position: relative;
            height: 100px; /* Reserve space */
        }

        /* Container for handwriting to keep pen relative to it */
        .writing-container {
            position: relative;
            display: inline-block;
        }

        /* The Handwritten Text Style */
        .handwriting {
            font-family: 'Dancing Script', cursive;
            font-weight: 700; /* Bold for clarity */
            font-size: 2.5rem; 
            color: #ff4081;
            text-shadow: 0 0 10px rgba(255, 64, 129, 0.3);
            line-height: 1.5;
            white-space: nowrap; /* Keep on one line for animation */
        }

        /* The Moving Pen (Absolute Positioned) */
        .feather-pen {
            position: absolute;
            font-size: 3rem;
            top: -30px; 
            left: 0; /* JS will move this */
            filter: drop-shadow(5px 5px 5px rgba(0,0,0,0.5));
            pointer-events: none;
            z-index: 20;
            /* The Magic: Smooth transition for gliding effect */
            transition: left 0.1s linear, top 0.1s linear;
        }

        /* Scribble Animation (The Up/Down Bobbing) */
        .scribbling {
            animation: scribble 0.2s infinite alternate;
        }

        @keyframes scribble {
            from { transform: rotate(0deg) translateY(0); }
            to { transform: rotate(15deg) translateY(-5px); }
        }

        /* Signature Section */
        .signature-area {
            margin-top: 50px;
            text-align: right;
            padding-right: 20px;
            display: none; 
        }
        
        .sig-text {
            font-family: 'Poppins', sans-serif;
            font-size: 0.9rem;
            color: #ccc;
            margin-bottom: 5px;
        }

        .sig-name {
            font-family: 'Dancing Script', cursive;
            font-weight: 700;
            font-size: 3rem;
            color: #fff;
        }

        /* Heartbeat Button */
        .heart-btn-container {
            margin-top: 60px;
            text-align: center;
            opacity: 0; 
            transition: opacity 2s ease;
            display: none;
        }

        .heart-btn {
            background: none;
            border: none;
            font-size: 5rem;
            cursor: pointer;
            color: #d81b60;
            animation: heartbeat 1.5s infinite;
            filter: drop-shadow(0 0 10px rgba(216, 27, 96, 0.8));
            transition: transform 0.3s;
        }

        .heart-btn:active { transform: scale(0.9); }

        @keyframes heartbeat {
            0% { transform: scale(1); }
            15% { transform: scale(1.3); }
            30% { transform: scale(1); }
            45% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }

        .instruction { font-size: 0.9rem; color: #888; margin-top: 10px; }

    </style>
</head>
<body>

    <div class="letter-container">
        <img src="https://i.postimg.cc/Hn3wPKym/9c43b51e-6892-4b02-a992-cbebd6a569c7.jpg" class="profile-img" alt="Ammu">
        
        <h1>My Dearest Ammu,</h1>
        
        <div class="message-box">
            <span id="typing-text"></span><span class="cursor"></span>
        </div>

        <div class="finale-section" id="finale-section">
            <div class="writing-container">
                <span id="finale-text" class="handwriting"></span>
                <div id="pen1" class="feather-pen scribbling">✒️</div>
            </div>
        </div>

        <div class="signature-area" id="signature-area">
            <div class="sig-text">With love yours,</div>
            <div class="writing-container">
                <span id="sig-name" class="sig-name"></span>
                <div id="pen2" class="feather-pen scribbling">✒️</div>
            </div>
        </div>

        <div class="heart-btn-container" id="heartContainer">
            <button class="heart-btn" onclick="finalLove()">❤️</button>
            <div class="instruction">Tap my heart to accept</div>
        </div>
    </div>

    <script>
        // ----------------------------------------------------
        // LETTER CONTENT
        // ----------------------------------------------------
        const segments = [
            { text: "It's crazy to think about it... January 19th, the day we first talked, and since then it's been 25 days.\n\n", speed: 50 },
            { text: "I know I joke around a lot. I know I built a contract asking for tea and cookies. I know I make fun of you sometimes.\n\n", speed: 40 },
            { text: "But I want you to know the truth.\n\n", speed: 100 },
            { text: "Even though you are miles away in British Columbia, and I am here in Halifax... you are the closest thing to my heart.\n\n", speed: 60 },
            { text: "You are my comfort, that one person with whom I enjoy every moment. You make me feel special every moment.\n\n", speed: 80 },
            { text: "I have never felt love the way you love me. In this world of all about oneself and ego, you stand out to be the definition of what love is.\n\n", speed: 70 },
            { text: "You are everything I ever wanted or dreamt of in my life, and seeing or realizing that dream of mine slowly fulfill is making me the luckiest person in the world.\n\n", speed: 60 },
            { text: "I used to think... why this long to meet someone? Why me? ", speed: 90 },
            { text: "I finally get it. It was to meet you at the perfect time. I met you when I was struggling, and that's when I realized how lucky I am.\n\n", speed: 70 },
            { text: "I want to achieve everything in our life with you by my side, celebrate with you our little successes, and be there for you always. I want to give you all happiness in your life.\n\n", speed: 60 },
            { text: "I will never stop loving you. Ammu, you are the best thing that happened in my life. Like the reel I shared you...\n\n", speed: 80 }
        ];

        const typingElement = document.getElementById('typing-text');
        const cursor = document.querySelector('.cursor');
        
        let segmentIndex = 0;
        let charIndex = 0;

        function typeWriter() {
            if (segmentIndex < segments.length) {
                const segment = segments[segmentIndex];
                if (charIndex < segment.text.length) {
                    const char = segment.text.charAt(charIndex);
                    if (char === '\n') typingElement.innerHTML += '<br>';
                    else typingElement.innerHTML += char;
                    
                    charIndex++;

                    // --- SMOOTH AUTO SCROLL ---
                    const rect = cursor.getBoundingClientRect();
                    // Scroll if cursor is near bottom
                    if (rect.bottom > window.innerHeight - 100) {
                        window.scrollBy({ top: 30, behavior: 'auto' });
                    }

                    let delay = segment.speed;
                    if (['.', '?', '!', ','].includes(char)) delay += 300; 

                    setTimeout(typeWriter, delay);
                } else {
                    segmentIndex++;
                    charIndex = 0;
                    setTimeout(typeWriter, 300); 
                }
            } else {
                // Main Letter Finished -> Start Finale
                startFinale();
            }
        }

        // --- FINALE LOGIC (Smooth Gliding Pen) ---
        function startFinale() {
            cursor.style.display = 'none'; // Hide main cursor
            
            // 1. Reveal Finale Section
            const finaleSection = document.getElementById('finale-section');
            finaleSection.style.display = 'block';
            
            // 2. FORCE SCROLL TO BOTTOM
            setTimeout(() => {
                window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
            }, 100);

            // 3. Start writing
            setTimeout(() => {
                writeSmoothly("finale-text", "YOU MAKE ME COMPLETE ❤️", "pen1", () => {
                    startSignature();
                });
            }, 1000);
        }

        function startSignature() {
            const sigArea = document.getElementById('signature-area');
            sigArea.style.display = 'block';
            
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });

            setTimeout(() => {
                writeSmoothly("sig-name", "Ebin", "pen2", () => {
                    showHeartButton();
                });
            }, 500);
        }

        // Logic for the Moving Pen (Smooth Glide)
        function writeSmoothly(textId, text, penId, callback) {
            const textEl = document.getElementById(textId);
            const penEl = document.getElementById(penId);
            let i = 0;
            
            function step() {
                if (i < text.length) {
                    // Add letter
                    textEl.innerHTML += text.charAt(i);
                    i++;
                    
                    // --- THE SMOOTH ANIMATION TRICK ---
                    // Calculate the new width of the text container
                    // and tell the pen to slide to that exact position
                    const currentWidth = textEl.offsetWidth;
                    penEl.style.left = currentWidth + 'px';

                    // Force scroll
                    window.scrollTo({ top: document.body.scrollHeight, behavior: 'auto' });
                    
                    setTimeout(step, 150); // Speed of writing
                } else {
                    // Finished writing
                    penEl.style.display = 'none'; // Hide pen
                    if (callback) callback();
                }
            }
            step();
        }

        function showHeartButton() {
            const btn = document.getElementById('heartContainer');
            btn.style.display = 'block';
            setTimeout(() => {
                btn.style.opacity = '1';
                window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
            }, 100);
        }

        // Start typing main letter after 1 second
        setTimeout(typeWriter, 1000);

        // Petals
        function createPetals() {
            const body = document.body;
            for(let i=0; i<30; i++) {
                const petal = document.createElement('div');
                petal.classList.add('petal');
                petal.style.left = Math.random() * 100 + 'vw';
                petal.style.width = Math.random() * 10 + 10 + 'px';
                petal.style.height = Math.random() * 10 + 10 + 'px';
                petal.style.backgroundColor = Math.random() < 0.5 ? '#d81b60' : '#ff80ab'; 
                petal.style.animationDuration = Math.random() * 5 + 5 + 's';
                petal.style.animationDelay = Math.random() * 5 + 's';
                body.appendChild(petal);
            }
        }
        createPetals();

        function finalLove() {
            alert("Vegam Poyi enik whatsapp msge ayakk");
        }

    </script>
</body>
</html>